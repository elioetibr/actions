{"version":3,"file":"tools.mjs","sources":["../../../src/tools/common/runner-base.ts"],"sourcesContent":["import type { IAgent, IRunner, IRunnerResult } from '../../agents/interfaces';\n\n/**\n * Abstract base class for tool runners\n * Provides common functionality and enforces the runner contract\n */\nexport abstract class RunnerBase implements IRunner {\n  abstract readonly name: string;\n\n  /**\n   * Map of available steps and their implementations\n   */\n  protected abstract readonly steps: Map<string, (agent: IAgent) => Promise<IRunnerResult>>;\n\n  /**\n   * Run a specific step of the tool\n   * @param agent - The CI/CD agent\n   * @param step - The step to run\n   * @returns Promise with the runner result\n   */\n  async run(agent: IAgent, step: string): Promise<IRunnerResult> {\n    const stepFn = this.steps.get(step);\n\n    if (!stepFn) {\n      const availableSteps = Array.from(this.steps.keys()).join(', ');\n      const error = new Error(\n        `Unknown step '${step}' for runner '${this.name}'. Available steps: ${availableSteps}`,\n      );\n      return {\n        success: false,\n        outputs: {},\n        error,\n      };\n    }\n\n    try {\n      return await stepFn(agent);\n    } catch (error) {\n      return {\n        success: false,\n        outputs: {},\n        error: error instanceof Error ? error : new Error(String(error)),\n      };\n    }\n  }\n\n  /**\n   * Helper to create a successful result\n   * @param outputs - The outputs to include\n   */\n  protected success(outputs: Record<string, string | number | boolean>): IRunnerResult {\n    return {\n      success: true,\n      outputs,\n    };\n  }\n\n  /**\n   * Helper to create a failed result\n   * @param error - The error that caused the failure\n   * @param outputs - Optional partial outputs\n   */\n  protected failure(\n    error: Error | string,\n    outputs: Record<string, string | number | boolean> = {},\n  ): IRunnerResult {\n    return {\n      success: false,\n      outputs,\n      error: error instanceof Error ? error : new Error(error),\n    };\n  }\n}\n"],"names":[],"mappings":"AAMO,MAAe,UAAA,CAA8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAclD,MAAM,GAAA,CAAI,KAAA,EAAe,IAAA,EAAsC;AAC7D,IAAA,MAAM,MAAA,GAAS,IAAA,CAAK,KAAA,CAAM,GAAA,CAAI,IAAI,CAAA;AAElC,IAAA,IAAI,CAAC,MAAA,EAAQ;AACX,MAAA,MAAM,cAAA,GAAiB,MAAM,IAAA,CAAK,IAAA,CAAK,MAAM,IAAA,EAAM,CAAA,CAAE,IAAA,CAAK,IAAI,CAAA;AAC9D,MAAA,MAAM,QAAQ,IAAI,KAAA;AAAA,QAChB,iBAAiB,IAAI,CAAA,cAAA,EAAiB,IAAA,CAAK,IAAI,uBAAuB,cAAc,CAAA;AAAA,OACtF;AACA,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,KAAA;AAAA,QACT,SAAS,EAAC;AAAA,QACV;AAAA,OACF;AAAA,IACF;AAEA,IAAA,IAAI;AACF,MAAA,OAAO,MAAM,OAAO,KAAK,CAAA;AAAA,IAC3B,SAAS,KAAA,EAAO;AACd,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,KAAA;AAAA,QACT,SAAS,EAAC;AAAA,QACV,KAAA,EAAO,iBAAiB,KAAA,GAAQ,KAAA,GAAQ,IAAI,KAAA,CAAM,MAAA,CAAO,KAAK,CAAC;AAAA,OACjE;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMU,QAAQ,OAAA,EAAmE;AACnF,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT;AAAA,KACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOU,OAAA,CACR,KAAA,EACA,OAAA,GAAqD,EAAC,EACvC;AACf,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,KAAA;AAAA,MACT,OAAA;AAAA,MACA,OAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,GAAQ,IAAI,MAAM,KAAK;AAAA,KACzD;AAAA,EACF;AACF;;;;"}